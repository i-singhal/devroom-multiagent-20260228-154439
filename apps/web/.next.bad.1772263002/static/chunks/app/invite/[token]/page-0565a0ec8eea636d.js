(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{2849:function(t,e,n){Promise.resolve().then(n.bind(n,9268))},9268:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return u}});var r=n(7573),o=n(7653),s=n(1695),a=n(5118),c=n(4382),i=n(5721);function u(){let{token:t}=(0,s.useParams)(),{user:e,loading:n}=(0,c.a)(),u=(0,s.useRouter)(),[l,d]=(0,o.useState)("joining"),[m,f]=(0,o.useState)("");return(0,o.useEffect)(()=>{if(!n){if(!e){u.push("/login?redirect=/invite/".concat(t));return}a.Hh.join(t).then(t=>{d("done"),setTimeout(()=>u.push("/rooms/".concat(t.data.roomId)),1e3)}).catch(t=>{var e,n;d("error"),f((null===(n=t.response)||void 0===n?void 0:null===(e=n.data)||void 0===e?void 0:e.error)||"Failed to join room")})}},[e,n,t,u]),(0,r.jsx)("div",{className:"min-h-screen bg-surface-950 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:["joining"===l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{className:"w-8 h-8 animate-spin text-brand-500 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-slate-400",children:"Joining room..."})]}),"done"===l&&(0,r.jsx)("p",{className:"text-green-400",children:"âœ“ Joined! Redirecting..."}),"error"===l&&(0,r.jsx)("p",{className:"text-red-400",children:m})]})})}},5118:function(t,e,n){"use strict";n.d(e,{Hh:function(){return m},I2:function(){return c},Mp:function(){return l},Vp:function(){return u},iJ:function(){return a},lC:function(){return i},ug:function(){return d}});var r=n(3908);let o=n(4859).env.NEXT_PUBLIC_API_URL||"http://localhost:4000",s=r.Z.create({baseURL:o,withCredentials:!0,headers:{"Content-Type":"application/json"}}),a={register:(t,e,n)=>s.post("/auth/register",{name:t,email:e,password:n}),login:(t,e)=>s.post("/auth/login",{email:t,password:e}),logout:()=>s.post("/auth/logout"),me:()=>s.get("/auth/me")},c={list:()=>s.get("/rooms"),get:t=>s.get("/rooms/".concat(t)),create:(t,e)=>s.post("/rooms",{title:t,goal:e}),plan:t=>s.post("/rooms/".concat(t,"/plan")),createInvite:t=>s.post("/rooms/".concat(t,"/invites"))},i={get:t=>s.get("/tasks/".concat(t)),assign:(t,e)=>s.post("/tasks/".concat(t,"/assign"),{assignedUserId:e}),updateStatus:(t,e,n)=>s.post("/tasks/".concat(t,"/status"),{status:e,blockedReason:n})},u={get:t=>s.get("/contracts/".concat(t)),propose:(t,e)=>s.post("/contracts/".concat(t,"/propose"),e),publish:(t,e)=>s.post("/contracts/".concat(t,"/publish"),e)},l={list:(t,e)=>s.get("/rooms/".concat(t,"/messages?channel=").concat(e)),sendMaster:(t,e,n)=>s.post("/rooms/".concat(t,"/messages/master"),{content:e,sharedFromMessageId:n}),sendWorker:(t,e)=>s.post("/rooms/".concat(t,"/messages/worker"),{content:e})},d={list:(t,e,n)=>s.get("/rooms/".concat(t,"/notebook"),{params:{q:e,category:n}}),create:(t,e)=>s.post("/rooms/".concat(t,"/notebook"),e)},m={join:t=>s.post("/invites/".concat(t,"/join"))}},4382:function(t,e,n){"use strict";n.d(e,{AuthProvider:function(){return c},a:function(){return i}});var r=n(7573),o=n(7653),s=n(5118);let a=(0,o.createContext)(null);function c(t){let{children:e}=t,[n,c]=(0,o.useState)(null),[i,u]=(0,o.useState)(!0);(0,o.useEffect)(()=>{s.iJ.me().then(t=>c(t.data)).catch(()=>c(null)).finally(()=>u(!1))},[]);let l=(0,o.useCallback)(async(t,e)=>{c((await s.iJ.login(t,e)).data)},[]),d=(0,o.useCallback)(async(t,e,n)=>{c((await s.iJ.register(t,e,n)).data)},[]),m=(0,o.useCallback)(async()=>{await s.iJ.logout(),c(null)},[]);return(0,r.jsx)(a.Provider,{value:{user:n,loading:i,login:l,register:d,logout:m},children:e})}function i(){let t=(0,o.useContext)(a);if(!t)throw Error("useAuth must be used within AuthProvider");return t}},2389:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(7653);let o=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.filter((t,e,n)=>!!t&&""!==t.trim()&&n.indexOf(t)===e).join(" ").trim()};var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,r.forwardRef)((t,e)=>{let{color:n="currentColor",size:o=24,strokeWidth:c=2,absoluteStrokeWidth:i,className:u="",children:l,iconNode:d,...m}=t;return(0,r.createElement)("svg",{ref:e,...a,width:o,height:o,stroke:n,strokeWidth:i?24*Number(c)/Number(o):c,className:s("lucide",u),...m},[...d.map(t=>{let[e,n]=t;return(0,r.createElement)(e,n)}),...Array.isArray(l)?l:[l]])}),i=(t,e)=>{let n=(0,r.forwardRef)((n,a)=>{let{className:i,...u}=n;return(0,r.createElement)(c,{ref:a,iconNode:e,className:s("lucide-".concat(o(t)),i),...u})});return n.displayName="".concat(t),n}},5721:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});let r=(0,n(2389).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1695:function(t,e,n){"use strict";var r=n(1219);n.o(r,"useParams")&&n.d(e,{useParams:function(){return r.useParams}}),n.o(r,"useRouter")&&n.d(e,{useRouter:function(){return r.useRouter}})}},function(t){t.O(0,[908,293,528,744],function(){return t(t.s=2849)}),_N_E=t.O()}]);