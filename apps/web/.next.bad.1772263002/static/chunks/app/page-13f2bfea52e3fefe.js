(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4016:function(e,t,s){Promise.resolve().then(s.bind(s,1403))},1403:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var a=s(7573),n=s(7653),c=s(1695),r=s(4382),l=s(5118),o=s(8146),i=s(5721),m=s(3172),u=s(3989),d=s(1095);function x(){let{user:e,loading:t}=(0,r.a)(),s=(0,c.useRouter)(),[x,h]=(0,n.useState)([]),[p,f]=(0,n.useState)(!1),[b,g]=(0,n.useState)(!1),[j,N]=(0,n.useState)(""),[v,w]=(0,n.useState)(""),[y,k]=(0,n.useState)(!1);(0,n.useEffect)(()=>{t||e||s.push("/login")},[e,t,s]),(0,n.useEffect)(()=>{e&&(f(!0),l.I2.list().then(e=>h(e.data)).catch(console.error).finally(()=>f(!1)))},[e]);let C=async()=>{if(j.trim()&&v.trim()){k(!0);try{let e=await l.I2.create(j.trim(),v.trim());s.push("/rooms/".concat(e.data.id))}catch(e){console.error(e)}finally{k(!1)}}};return t?(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,a.jsx)(i.Z,{className:"animate-spin w-8 h-8 text-brand-500"})}):e?(0,a.jsxs)("div",{className:"min-h-screen bg-surface-950",children:[(0,a.jsxs)("header",{className:"border-b border-white/5 px-6 py-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-brand-600 rounded-lg flex items-center justify-center text-sm font-bold",children:"D"}),(0,a.jsx)("span",{className:"font-semibold text-white",children:"DevRoom"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-sm text-slate-400",children:e.name}),(0,a.jsxs)("button",{onClick:()=>g(!0),className:"btn-primary flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),"New Room"]})]})]}),(0,a.jsxs)("main",{className:"max-w-4xl mx-auto px-6 py-12",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-8",children:"Your Dev Rooms"}),p?(0,a.jsx)("div",{className:"flex justify-center py-12",children:(0,a.jsx)(i.Z,{className:"animate-spin w-6 h-6 text-brand-500"})}):0===x.length?(0,a.jsxs)("div",{className:"card p-12 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-brand-600/20 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(u.Z,{className:"w-8 h-8 text-brand-400"})}),(0,a.jsx)("p",{className:"text-slate-400 mb-4",children:"No rooms yet. Create one to get started."}),(0,a.jsx)("button",{onClick:()=>g(!0),className:"btn-primary",children:"Create your first room"})]}):(0,a.jsx)("div",{className:"grid gap-4",children:x.map(e=>(0,a.jsx)(o.default,{href:"/rooms/".concat(e.id),className:"card p-5 hover:border-brand-500/30 transition-colors block",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"font-semibold text-white",children:e.title}),(0,a.jsxs)("p",{className:"text-sm text-slate-400 mt-1 flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"w-3.5 h-3.5"}),e.goal]})]}),(0,a.jsx)("span",{className:"badge ".concat("owner"===e.role?"bg-brand-600/20 text-brand-300":"bg-slate-700 text-slate-300"),children:e.role})]})},e.id))})]}),b&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"card p-6 w-full max-w-md",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Create Dev Room"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-slate-400 mb-1 block",children:"Room Title"}),(0,a.jsx)("input",{className:"input",placeholder:"e.g. Payment Service v2",value:j,onChange:e=>N(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-slate-400 mb-1 block",children:"Goal"}),(0,a.jsx)("textarea",{className:"input resize-none",rows:3,placeholder:"e.g. Build a new checkout flow with Stripe integration",value:v,onChange:e=>w(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,a.jsx)("button",{onClick:()=>g(!1),className:"btn-ghost flex-1",children:"Cancel"}),(0,a.jsxs)("button",{onClick:C,className:"btn-primary flex-1 flex items-center justify-center gap-2",disabled:y||!j||!v,children:[y?(0,a.jsx)(i.Z,{className:"w-4 h-4 animate-spin"}):null,"Create Room"]})]})]})]})})]}):null}},5118:function(e,t,s){"use strict";s.d(t,{Hh:function(){return d},I2:function(){return l},Mp:function(){return m},Vp:function(){return i},iJ:function(){return r},lC:function(){return o},ug:function(){return u}});var a=s(3908);let n=s(4859).env.NEXT_PUBLIC_API_URL||"http://localhost:4000",c=a.Z.create({baseURL:n,withCredentials:!0,headers:{"Content-Type":"application/json"}}),r={register:(e,t,s)=>c.post("/auth/register",{name:e,email:t,password:s}),login:(e,t)=>c.post("/auth/login",{email:e,password:t}),logout:()=>c.post("/auth/logout"),me:()=>c.get("/auth/me")},l={list:()=>c.get("/rooms"),get:e=>c.get("/rooms/".concat(e)),create:(e,t)=>c.post("/rooms",{title:e,goal:t}),plan:e=>c.post("/rooms/".concat(e,"/plan")),createInvite:e=>c.post("/rooms/".concat(e,"/invites"))},o={get:e=>c.get("/tasks/".concat(e)),assign:(e,t)=>c.post("/tasks/".concat(e,"/assign"),{assignedUserId:t}),updateStatus:(e,t,s)=>c.post("/tasks/".concat(e,"/status"),{status:t,blockedReason:s})},i={get:e=>c.get("/contracts/".concat(e)),propose:(e,t)=>c.post("/contracts/".concat(e,"/propose"),t),publish:(e,t)=>c.post("/contracts/".concat(e,"/publish"),t)},m={list:(e,t)=>c.get("/rooms/".concat(e,"/messages?channel=").concat(t)),sendMaster:(e,t,s)=>c.post("/rooms/".concat(e,"/messages/master"),{content:t,sharedFromMessageId:s}),sendWorker:(e,t)=>c.post("/rooms/".concat(e,"/messages/worker"),{content:t})},u={list:(e,t,s)=>c.get("/rooms/".concat(e,"/notebook"),{params:{q:t,category:s}}),create:(e,t)=>c.post("/rooms/".concat(e,"/notebook"),t)},d={join:e=>c.post("/invites/".concat(e,"/join"))}},4382:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return l},a:function(){return o}});var a=s(7573),n=s(7653),c=s(5118);let r=(0,n.createContext)(null);function l(e){let{children:t}=e,[s,l]=(0,n.useState)(null),[o,i]=(0,n.useState)(!0);(0,n.useEffect)(()=>{c.iJ.me().then(e=>l(e.data)).catch(()=>l(null)).finally(()=>i(!1))},[]);let m=(0,n.useCallback)(async(e,t)=>{l((await c.iJ.login(e,t)).data)},[]),u=(0,n.useCallback)(async(e,t,s)=>{l((await c.iJ.register(e,t,s)).data)},[]),d=(0,n.useCallback)(async()=>{await c.iJ.logout(),l(null)},[]);return(0,a.jsx)(r.Provider,{value:{user:s,loading:o,login:m,register:u,logout:d},children:t})}function o(){let e=(0,n.useContext)(r);if(!e)throw Error("useAuth must be used within AuthProvider");return e}}},function(e){e.O(0,[908,444,293,528,744],function(){return e(e.s=4016)}),_N_E=e.O()}]);